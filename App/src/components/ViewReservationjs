import React, { useState } from 'react';
import { useNavigate } from "react-router-dom";
import './../style/View.css';



function ViewReservation() {

    const [reservationId, setReservationId] = useState('');
    const [reservationDetails, setReservationDetails] = useState(null);
    const [error, setError] = useState(null); 
    const navigate = useNavigate();
    
    function isFormatValidReservationId(reservationId) {
    const regex=/^[A-Z]{1}\d{9}$/;
    const isValid=regex.test(reservationId);
    if(!isValid) {
        setError("The format you have entered is invalid. Please try again.");
        return false;
    }

    return true;

    }


    const callAPI = async () => {
      if (!isFormatValidReservationId(reservationId)) {
        return;
    }

        try {
          const response = await fetch(`http://localhost:9000/reservationRoute/${reservationId}`, {
            method: "VIEW",
            headers: {
              "Content-Type": "application/json",
            },
    
          });
    
          const data = await response.json();
    
          if (response.ok){
           //console.log('Reservation successfully canceled');
           }
           else { setError(response.statusText);
             console.error('Failed to retrieve reservation:', response.statusText);}
        
        } catch (error) {
          setError(error.message);
          console.error(error);
        }
      };
    

    const handleSubmit = (e) => { 
        e.preventDefault(); 
          callAPI();

      };
    
      const handleChange = (e) => {
        setReservationId(e.target.value);
      };

return (
    <form  onSubmit={handleSubmit}  action="ViewR">
      <label> Reservation ID:
      <input
            type="text"
            value={reservationId} 
            placeholder="Enter Reservation ID"
            required
            onChange={handleChange}
          ></input>
      </label>
        
        <button type="submit">View</button>
   
    </form>
  );
}
export default ViewReservation;